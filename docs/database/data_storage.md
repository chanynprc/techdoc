## 辅助存储管理

### 概念
 
**辅助存储器**：磁盘和其他能够存储大量需要长期保存的数据的设备
 
### DBMS非易失需求

数据库中的任何修改都不能认为是最终有效的，直到改修改被存储到非易失性的辅助存储器中。
 
### 主存数据库系统

主存数据库系统是通过虚存来管理它们的数据，依靠操作系统，通过页面机制把所需要的数据带到主存。
 
### 磁盘调度的电梯算法

把磁头看作是在做横跨磁盘的扫描，从柱面的最内圈到最外圈，然后再返回来，正如电梯做垂直运动。当磁头通过柱面时，如果有一个或多个对该柱面上的块的请求，磁头就停下来，根据请求，所有这些块都被读写。然后磁头沿着其正在行进的方向继续移动，直至遇到下一个包含要访问块的柱面。当磁头到达其行进方向上的某一位置时，在该位置的前方不再有访问请求，磁头就朝相反方向移动。
 
### 磁盘故障处理方法
 
#### RAID 1级：冗余镜像

使用一个额外的磁盘（冗余盘）镜像数据盘。
 
#### RAID 4级：奇偶块

仅使用一个冗余盘，不管有多少数据盘，并假设所有磁盘是相同的。在冗余盘中，第i块由所有数据盘的第i块奇偶校验位组成。

读取数据没有什么差别。在写数据时，不仅需要改变数据盘的那个块，而且需要改变冗余盘的相应块，以便它能继续保持为所有数据盘相应块的奇偶校验。基本的步骤是：（1）读取被改变数据盘上的旧值，（2）读取冗余盘的相应块，（3）写新数据块，（4）重新计算并写冗余盘的块。

故障恢复的方式是对所有其他盘（包括冗余盘）上的对应块进行模2和计算，即可恢复数据。
 
#### RAID 5级：优化的RAID 4

RAID 4级的冗余盘读写相对过于频繁，而模2和方法并不区分数据盘和冗余盘，所以在此基础上进行改进。可以把每个磁盘作为某些块的冗余盘来处理。例如，有n+1个编号为0到n的磁盘，如果j是当i被n+1除时的余数，我们可以把盘j的第i个柱面看作冗余。
 
#### RAID 6级：多个盘崩溃

有一个纠错码原理，允许处理多个磁盘（数据盘或冗余盘）崩溃问题，前提是我们使用足够多的冗余盘。海明码是一种最简单的纠错码。
